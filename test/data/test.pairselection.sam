@HD	VN:1.4	SO:queryname
@SQ	SN:targetref	LN:21
@SQ	SN:wrongref	LN:300
@CO	Tests that sam records are parsed and mate pairs are selected correctly.
# qname, flag, rname, pos, mapq, cigar, rnext, pnext, tlen, seq, qual
tc1_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:Paired mapped records followed by single mapped record.  Expect paired record merged into 1 seq in fasta.  Single record has 1 seq in fasta.
tc1_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:Paired mapped records followed by single mapped record.  Expect paired record merged into 1 seq in fasta.  Single record has 1 seq in fasta.
tc1_read2	0	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:Paired mapped records followed by single mapped record.  Expect paired record merged into 1 seq in fasta.  Single record has 1 seq in fasta.

tc2_read1	0	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:single mapped record followed by paired mapped record..  Expect paired record is merged into 1 sequence in fasta.  single record has 1 sequence in fasta.
tc2_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:single mapped record followed by paired mapped record..  Expect paired record is merged into 1 sequence in fasta.  single record has 1 sequence in fasta.
tc2_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:single mapped record followed by paired mapped record..  Expect paired record is merged into 1 sequence in fasta.  single record has 1 sequence in fasta.



tc3_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired mapped record followed by paired record with only 1st mate mapped.  Expected-paired record is merged into 1 sequence in fasta.  1st mapped mate in last pair has 1 sequence in fasta.
tc3_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired mapped record followed by paired record with only 1st mate mapped.  Expected-paired record is merged into 1 sequence in fasta.  1st mapped mate in last pair has 1 sequence in fasta.
tc3_read2	73	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:paired mapped record followed by paired record with only 1st mate mapped.  Expected-paired record is merged into 1 sequence in fasta.  1st mapped mate in last pair has 1 sequence in fasta.
tc3_read2	133	*	0	255	*	targetref	5	0	*	*	CO:paired mapped record followed by paired record with only 1st mate mapped.  Expected-paired record is merged into 1 sequence in fasta.  1st mapped mate in last pair has 1 sequence in fasta.



tc4_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired mapped record followed by paired record with only 2nd mate mapped. Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in last pair has 1 sequence in fasta.
tc4_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired mapped record followed by paired record with only 2nd mate mapped. Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in last pair has 1 sequence in fasta.
tc4_read2	69	*	0	255	*	targetref	5	0	*	*	CO:paired mapped record followed by paired record with only 2nd mate mapped. Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in last pair has 1 sequence in fasta.
tc4_read2	137	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:paired mapped record followed by paired record with only 2nd mate mapped. Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in last pair has 1 sequence in fasta.


tc5_read1	73	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:paired record with only 1st mate mapped followed by paired mapped record.  Expected - paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc5_read1	133	*	0	255	*	targetref	5	0	*	*	CO:paired record with only 1st mate mapped followed by paired mapped record.  Expected - paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc5_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with only 1st mate mapped followed by paired mapped record.  Expected - paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc5_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with only 1st mate mapped followed by paired mapped record.  Expected - paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.


tc6_read1	69	*	0	255	*	targetref	5	0	*	*	CO:paired record with only 2nd mate mapped followed by paired mapped record.  Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc6_read1	137	targetref	5	30	7M	*	0	0	CCTAGAC	HHHHHHH	CO:paired record with only 2nd mate mapped followed by paired mapped record.  Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc6_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with only 2nd mate mapped followed by paired mapped record.  Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc6_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with only 2nd mate mapped followed by paired mapped record.  Expected -  paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.

tc7_read1	99	targetref	4	30	8M	wrongref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref, 2nd mate mapped to wrong ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc7_read1	147	wrongref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref, 2nd mate mapped to wrong ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc7_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref, 2nd mate mapped to wrong ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc7_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref, 2nd mate mapped to wrong ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.

tc8_read1	99	wrongref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to wrong ref, 2nd mate mapped to right ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc8_read1	147	targetref	6	30	8M	wrongref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to wrong ref, 2nd mate mapped to right ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc8_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to wrong ref, 2nd mate mapped to right ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc8_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to wrong ref, 2nd mate mapped to right ref, followed by paired record mapped to right ref.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.

tc9_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with low qual, 2nd mate mapped to right ref with high qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc9_read1	147	targetref	6	1	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with low qual, 2nd mate mapped to right ref with high qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc9_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with low qual, 2nd mate mapped to right ref with high qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.
tc9_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with low qual, 2nd mate mapped to right ref with high qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  1st mapped mate in first pair has 1 sequence in fasta.

tc10_read1	99	targetref	4	1	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with hi qual, 2nd mate mapped to right ref with low qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc10_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with hi qual, 2nd mate mapped to right ref with low qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc10_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with hi qual, 2nd mate mapped to right ref with low qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.
tc10_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record with 1st mate mapped to target ref with hi qual, 2nd mate mapped to right ref with low qual, followed by paired record mapped to right ref with high qual.  Expected: paired record is merged into 1 sequence in fasta.  2nd mapped mate in first pair has 1 sequence in fasta.


tc11_read1	355	targetref	4	30	6M	targetref	6	10	CCTAG	HHHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc11_read1	2147	targetref	17	30	5M	targetref	6	10	CAGGT	HHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc11_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc11_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc11_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc11_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.

tc12_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc12_read1	419	targetref	5	30	6M	targetref	6	10	CCTAG	HHHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc12_read1	2195	targetref	17	30	5M	targetref	6	10	CAGGT	HHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc12_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc12_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc12_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate alignment on target ref, 2nd mate secondary alignment on target ref & chimeric alignment on target ref & primary alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.

tc13_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc13_read1	355	targetref	5	30	6M	targetref	6	10	CCTAG	HHHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc13_read1	2147	targetref	17	30	5M	targetref	6	10	CAGGT	HHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc13_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc13_read2	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.
tc13_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:1st mate primary alignment on target ref, secondary alignment on target ref & chimeric alignment on target ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref.  Expected: 1st pair primary nonchimeric alignments merged into 1 sequence in fasta.  2nd pair merged into 1 sequence in fasta.

tc14_read1	355	targetref	5	30	6M	targetref	6	10	CCTAG	HHHHHH	CO:paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref but 1st mate record not in sam.  Expected: 1st pair - 2nd mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc14_read1	2147	targetref	17	30	5M	targetref	6	10	CAGGT	HHHHH	CO:paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref but 1st mate record not in sam.  Expected: 1st pair - 2nd mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc14_read1	99	wrongref	11	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref but 1st mate record not in sam.  Expected: 1st pair - 2nd mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc14_read1	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref but 1st mate record not in sam.  Expected: 1st pair - 2nd mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc14_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref, followed by paired record mapped to target ref but 1st mate record not in sam.  Expected: 1st pair - 2nd mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.

tc15_read1	99	targetref	4	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record mapped to target ref but 2nd mate record not in sam, followed by paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref.  Expected: 1st pair - 1st mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc15_read2	355	targetref	5	30	6M	targetref	6	10	CCTAG	HHHHHH	CO:paired record mapped to target ref but 2nd mate record not in sam, followed by paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref.  Expected: 1st pair - 1st mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc15_read2	2147	targetref	17	30	5M	targetref	6	10	CAGGT	HHHHH	CO:paired record mapped to target ref but 2nd mate record not in sam, followed by paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref.  Expected: 1st pair - 1st mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc15_read2	99	wrongref	11	30	8M	targetref	6	10	GCCTAGAC	HHHHHHHH	CO:paired record mapped to target ref but 2nd mate record not in sam, followed by paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref.  Expected: 1st pair - 1st mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.
tc15_read2	147	targetref	6	30	8M	targetref	4	10	CTAGACAT	HHHHHHHH	CO:paired record mapped to target ref but 2nd mate record not in sam, followed by paired record - 1st mate secondary alignment on target ref, chimeric alignment on target ref, primary alignment on wrong ref, 2nd mate alignment on target ref.  Expected: 1st pair - 1st mate sequence in fasta.  2nd pair - 2nd mate sequence in fasta.

tc16_read1	99	wrongref	4	30	8M	wrongref	6	10	GCCTAGAC	HHHHHHHH	CO:pair mapped to wrong ref followed by another pair mapped to wrong ref.  Expect: nothing written to fasta
tc16_read1	147	wrongref	6	30	8M	wrongref	4	10	CTAGACAT	HHHHHHHH	CO:pair mapped to wrong ref followed by another pair mapped to wrong ref.  Expect: nothing written to fasta
tc16_read2	99	wrongref	4	30	8M	wrongref	6	10	GCCTAGAC	HHHHHHHH	CO:pair mapped to wrong ref followed by another pair mapped to wrong ref.  Expect: nothing written to fasta
tc16_read2	147	wrongref	6	30	8M	wrongref	4	10	CTAGACAT	HHHHHHHH	CO:pair mapped to wrong ref followed by another pair mapped to wrong ref.  Expect: nothing written to fasta
